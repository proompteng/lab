services:
  openwebui:
    image: ghcr.io/open-webui/open-webui:v0.6.40
    container_name: jangar-openwebui
    ports:
      - "${OPENWEBUI_PORT:-8080}:8080"
    environment:
      - OPENAI_API_BASE_URL=${JANGAR_OPENAI_BASE_URL:-http://host.docker.internal:3000/openai/v1}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-changeme}
      - DEFAULT_MODELS=meta-orchestrator
      - ENABLE_OPENAI_API=true
      - BYPASS_MODEL_ACCESS_CONTROL=true
      - ENABLE_SIGNUP=false
      - DEFAULT_USER_ROLE=admin
      - WEBUI_AUTH=false
      - ENABLE_LOGIN_FORM=false
    volumes:
      - openwebui-data:/app/backend/data
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: unless-stopped
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080"]
      interval: 10s
      timeout: 3s
      retries: 10
      start_period: 10s

volumes:
  openwebui-data:
