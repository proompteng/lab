# temporal-bun-sdk-example

Sample project generated by `temporal-bun init`. It demonstrates how to run a Bun-native Temporal worker with the Zig bridge and includes scripts for local development and Docker packaging.

## Prerequisites
- Bun ≥ 1.1.20
- Temporal CLI ≥ 1.4 (install via `curl -sSfL https://temporal.download/cli.sh | bash -s -- -b /usr/local/bin`)
- Optional: Zig 0.15.1 if you plan to rebuild the bridge for unsupported platforms

## Quickstart

1. Install dependencies:
   ```bash
   bun install
   ```
2. Export your Temporal connection details (or create an `.env` file):
   ```bash
   export TEMPORAL_ADDRESS=127.0.0.1:7233
   export TEMPORAL_NAMESPACE=default
   export TEMPORAL_TASK_QUEUE=prix
   export TEMPORAL_BUN_SDK_USE_ZIG=1
   ```
3. (Optional) Start the Temporal CLI dev server:
   ```bash
   temporal server start-dev --ui false
   ```
4. Run the worker:
   ```bash
   TEMPORAL_BUN_SDK_USE_ZIG=1 bun run dev
   ```
   The worker loads workflows from `src/workflows/index.ts` and activities from `src/activities/index.ts`.

5. Trigger the sample workflow using the Temporal CLI while the worker is running:
   ```bash
   temporal workflow start \
     --task-queue "$TEMPORAL_TASK_QUEUE" \
     --workflow-type helloWorkflow \
     --input '"Codex"'
   ```
   The worker logs the request and completes after a short delay.

## TLS & API Keys
- Provide `TEMPORAL_API_KEY=<secret>` when targeting Temporal Cloud.
- For mTLS, set `TEMPORAL_TLS_CA_PATH`, `TEMPORAL_TLS_CERT_PATH`, and `TEMPORAL_TLS_KEY_PATH` to PEM-encoded files.
- Use `TEMPORAL_TLS_SERVER_NAME=<hostname>` if the certificate requires an SNI override.
- Allow self-signed certificates during testing with `TEMPORAL_ALLOW_INSECURE=1`.

## Packaging a Docker Image
```bash
bun run docker:build --tag temporal-bun-sdk-example:latest
```
The script produces a multi-stage image that runs `bun install`, bundles the Zig bridge artefacts from `@proompteng/temporal-bun-sdk`, and sets up the worker entrypoint.

## Cleanup
- Stop the worker with `Ctrl+C`.
- Shut down the dev server (if started) with `temporal server stop-dev`.

## Troubleshooting
See [`../temporal-bun-sdk/docs/troubleshooting.md`](../temporal-bun-sdk/docs/troubleshooting.md) for bridge loading, TLS, and CI tips.
