apiVersion: clickhouse-keeper.altinity.com/v1
kind: ClickHouseKeeperInstallation
metadata:
  name: torghut-keeper
  namespace: torghut
  labels:
    app.kubernetes.io/name: torghut-keeper
    app.kubernetes.io/part-of: torghut
  annotations:
    argocd.argoproj.io/sync-wave: "0"
spec:
  configuration:
    clusters:
      - name: default
        layout:
          replicasCount: 1
        templates:
          podTemplate: chk-default
          volumeClaimTemplate: chk-data
  templates:
    podTemplates:
      - name: chk-default
        spec:
          nodeSelector:
            kubernetes.io/arch: arm64
          containers:
            - name: clickhouse-keeper
              resources:
                requests:
                  cpu: 250m
                  memory: 256Mi
                limits:
                  cpu: 500m
                  memory: 512Mi
    volumeClaimTemplates:
      - name: chk-data
        spec:
          accessModes:
            - ReadWriteOnce
          resources:
            requests:
              storage: 1Gi
          storageClassName: longhorn
  defaults:
    templates:
      podTemplate: chk-default
      volumeClaimTemplate: chk-data
