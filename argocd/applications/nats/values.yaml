fullnameOverride: nats

config:
  cluster:
    enabled: true
    replicas: 3
  jetstream:
    enabled: true
    fileStore:
      enabled: true
      pvc:
        enabled: true
        size: 20Gi
        storageClassName: longhorn
      maxSize: 20Gi
  merge:
    http_port: 8222
    authorization:
      users:
        - nkey: UC5KXXLYUNIIKIL37XWUVY3CDPLQQ5QTKXHBXYMUOK4A3OGAKLEXLOSQ
          permissions:
            publish:
              - ">"
            subscribe:
              - ">"
        - user: agents
          password: << $NATS_AGENTS_PASSWORD >>
          permissions:
            publish:
              - "$JS.API.>"
              - "$JS.ACK.>"
              - "argo.workflow.>"
              - "workflow_comms.agent_messages.>"
            subscribe:
              - "_INBOX.>"
              - "argo.workflow.>"
              - "workflow_comms.agent_messages.>"
        - user: jangar
          password: << $NATS_JANGAR_PASSWORD >>
          permissions:
            publish:
              - "$JS.API.>"
              - "$JS.ACK.>"
            subscribe:
              - "argo.workflow.>"
              - "_INBOX.>"
              - "workflow_comms.agent_messages.>"

container:
  env:
    NATS_AGENTS_PASSWORD:
      valueFrom:
        secretKeyRef:
          name: nats-agents-credentials
          key: password
    NATS_JANGAR_PASSWORD:
      valueFrom:
        secretKeyRef:
          name: nats-jangar-credentials
          key: password
  resources:
    requests:
      cpu: 200m
      memory: 512Mi
    limits:
      cpu: 1
      memory: 2Gi
